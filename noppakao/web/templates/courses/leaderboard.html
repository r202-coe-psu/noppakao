{% extends "base/default-page-user.html" %}
{% block content %}

<div class="flex flex-col gap-7">
    <p class="font-bold text-2xl">Leaderboard</p>
    {% set page_num = request.args.get('page', 1) | int %}
    {% if page_num == 1 %}
    <!-- Podium Section -->
    <div class="border-2 border-gray-200 dark:border-gray-700 rounded-2xl mx-20">
        <!-- Podium Container -->
        <div class="flex items-end justify-center mt-10">
            <!-- 2nd Place -->
            <div class="flex flex-col items-center w-32 group cursor-pointer">
                <div class="flex flex-col items-center transform transition-all duration-300 hover:scale-110 hover:-translate-y-2">
                    <div class="relative">
                        <div class="absolute inset-0 bg-gradient-to-br from-gray-300 to-gray-500 rounded-full w-16 h-16 blur-md opacity-50 group-hover:opacity-70 transition-opacity"></div>
                        <i class="ph ph-trophy text-6xl text-transparent bg-gradient-to-br from-gray-300 via-gray-400 to-gray-600 bg-clip-text relative z-10 drop-shadow-lg"></i>
                    </div>
                    <div class="mt-3 px-3 py-1 bg-white/80 dark:bg-gray-800/80 backdrop-blur-sm rounded-xl shadow-lg ">
                        <span class="text-sm font-bold text-gray-600 dark:text-gray-300 block truncate w-24 text-center">{{ pagination.data[1]['display_name'] if pagination.data|length > 1 else '' }}</span>
                        <span class="text-xs font-semibold text-gray-500 dark:text-gray-400 block text-center">{{ "Level " + pagination.data[1]['level']|string if pagination.data|length > 1 else '' }}</span>
                    </div>
                </div>
                <div class="bg-gradient-to-br from-gray-400 via-gray-500 to-gray-600 text-white rounded-t-2xl flex items-center justify-center w-full h-28 text-2xl font-black shadow-2xl mt-4 transform transition-all duration-300 group-hover:scale-105 group-hover:shadow-3xl">
                    <span class="drop-shadow-lg">2</span>
                </div>
            </div>
            
            <!-- 1st Place -->
            <div class="flex flex-col items-center w-36 group cursor-pointer">
                <div class="flex flex-col items-center transform transition-all duration-300 hover:scale-110 hover:-translate-y-3">
                    <div class="relative">
                        <div class="absolute inset-0 bg-gradient-to-br from-yellow-300 to-yellow-500 rounded-full w-20 h-20 blur-lg opacity-60 group-hover:opacity-80 transition-opacity a"></div>
                        <i class="ph ph-trophy text-8xl text-transparent bg-gradient-to-br from-yellow-300 via-yellow-400 to-yellow-600 bg-clip-text relative z-10 drop-shadow-2xl"></i>
                    </div>
                    <div class="mt-4 px-4 py-2 bg-white/90 dark:bg-gray-800/90 backdrop-blur-sm rounded-xl shadow-xl">
                        <span class="text-base font-black text-gray-700 dark:text-gray-200 block truncate w-28 text-center">{{ pagination.data[0]['display_name'] if pagination.data|length > 0 else '' }}</span>
                        <span class="text-sm font-bold text-yellow-600 dark:text-yellow-400 block text-center">{{ "Level " + pagination.data[0]['level']|string if pagination.data|length > 0 else '' }}</span>
                    </div>
                </div>
                <div class="bg-gradient-to-br from-yellow-400 via-yellow-500 to-yellow-600 text-white rounded-t-2xl flex items-center justify-center w-full h-36 text-3xl font-black shadow-2xl mt-4 transform transition-all duration-300 group-hover:scale-110 group-hover:shadow-3xl relative overflow-hidden">
                    <div class="absolute inset-0 bg-gradient-to-t from-yellow-600/20 to-transparent"></div>
                    <span class="drop-shadow-xl relative z-10">1</span>
                    <div class="absolute top-0 left-0 w-full h-1 bg-gradient-to-r from-transparent via-white/30 to-transparent"></div>
                </div>
            </div>
            
            <!-- 3rd Place -->
            <div class="flex flex-col items-center w-32 group cursor-pointer">
                <div class="flex flex-col items-center transform transition-all duration-300 hover:scale-110 hover:-translate-y-2">
                    <div class="relative">
                        <div class="absolute inset-0 bg-gradient-to-br from-orange-400 to-orange-600 rounded-full w-14 h-14 blur-md opacity-50 group-hover:opacity-70 transition-opacity"></div>
                        <i class="ph ph-trophy text-5xl text-transparent bg-gradient-to-br from-orange-400 via-orange-500 to-orange-700 bg-clip-text relative z-10 drop-shadow-lg"></i>
                    </div>
                    <div class="mt-3 px-3 py-1 bg-white/80 dark:bg-gray-800/80 backdrop-blur-sm rounded-xl shadow-lg border">
                        <span class="text-sm font-bold text-gray-600 dark:text-gray-300 block truncate w-24 text-center">{{ pagination.data[2]['display_name'] if pagination.data|length > 2 else '' }}</span>
                        <span class="text-xs font-semibold text-gray-500 dark:text-gray-400 block text-center">{{ "Level " + pagination.data[2]['level']|string if pagination.data|length > 2 else '' }}</span>
                    </div>
                </div>
                <div class="bg-gradient-to-br from-orange-800 via-orange-800 to-orange-900 text-white rounded-t-2xl flex items-center justify-center w-full h-24 text-xl font-black shadow-2xl mt-4 transform transition-all duration-300 group-hover:scale-105 group-hover:shadow-3xl">
                    <span class="drop-shadow-lg">3</span>
                </div>
            </div>
        </div>
    </div>
    {% endif %}
    <div class="overflow-x-auto rounded-box border border-base-content/5 bg-base-100">
        <table class="table">
            <thead>
                <tr>
                    <th class="text-center">Place</th>
                    <th>Name</th>
                    <th class="text-center">Level</th>
                    <th>Exp</th>
                </tr>
            </thead>
            <tbody>
                {% for user in pagination.data %}
                {% set index = (loop.index + ((request.args.get('page', 1) | int - 1) * pagination.items_per_page)) %}
                {% if index > 3 %}
                <tr>
                    <th class="text-center">{{ index }}</th>
                    <td>{{ user['display_name'] }}</td>
                    <td class="text-center">{{ user['level'] }}</td>
                    <td><progress class="progress progress-primary w-full" value="{{ user['percentage'] }}" max="100"></progress>
                    </td>
                </tr>
                {% endif %}
                {% endfor %}
            </tbody>
        </table>
    </div>
    <div class="mt-4">
    {% with redirect=url_for("course.leaderboard") %}
    {% include "base/pagination.html" %}
    {% endwith %}
    </div>
</div>
{% endblock %}